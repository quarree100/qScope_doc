<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Setup &mdash; qScope-doc 0.0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Frontend" href="frontend.html" />
    <link rel="prev" title="QUARREE100" href="QUARREE100.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            qScope-doc
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="QUARREE100.html">QUARREE100</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#hardware-overview">Hardware Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#software-overview">Software Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#framework-architecture">Framework Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data">Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#starting-the-software">Starting the software</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#calibrating-the-table">Calibrating the Table:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="frontend.html">Frontend</a></li>
<li class="toctree-l1"><a class="reference internal" href="tag_decoder.html">Tag Decoder (cspy)</a></li>
<li class="toctree-l1"><a class="reference internal" href="communication.html">Communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="infoscreen.html">Infoscreen</a></li>
<li class="toctree-l1"><a class="reference internal" href="ABM.html">ABM</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">qScope-doc</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Setup</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/setup.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this heading"></a></h1>
<p>Starting from the beginning: This section will show you how the Q-Scope is built, both physically and its software.</p>
<section id="hardware-overview">
<h2>Hardware Overview<a class="headerlink" href="#hardware-overview" title="Permalink to this heading"></a></h2>
<img alt="_images/CAD_closeUp_annotated.png" class="align-center" src="_images/CAD_closeUp_annotated.png" />
<p>The whole setup is made of two physical tables, with interactive components on top; two cameras sitting inside the tables; a projector casting an image onto the tables; and a TV screen to show additional information.
The table tops are of acrylic glass, on top of which there is a grid of tiles. Some of the tiles are tagged on the underside, so they can be decoded by the cameras from below. Each interaction with any of the tagged tiles will cause the projection and the infoscreen to respond in real time.</p>
<img alt="Image of four 3D-printed, colored houses with black and white tags on the underside." class="align-center" src="_images/Q-Scope_tangibles_tags.jpg" />
<p>In the image above you see four groups of <a class="reference internal" href="tag_decoder.html#programming-tangibles"><span class="std std-ref">tangibles</span></a> - objects with the same color (human-readable) share the same tag (machine-readable).</p>
</section>
<section id="software-overview">
<h2>Software Overview<a class="headerlink" href="#software-overview" title="Permalink to this heading"></a></h2>
<img alt="Here you should see a schematic overview on the different software components the Q-Scope setup requires: cspy, frontend, infoscreen, abm" class="align-center" src="_images/Q-Scope_software_components.png" />
<p>Each physical component of the setup has a piece of software it is linked with.
The image stream (camera) of the grid of tiles are scanned and decoded by <a class="reference internal" href="tag_decoder.html#cspy"><span class="std std-ref">cspy</span></a>. The software sends the grid information to the <a class="reference internal" href="frontend.html#frontend"><span class="std std-ref">frontend</span></a> (projector), which will cast an adjusted interface onto the table accordingly and send information about the machine state to the <a class="reference internal" href="infoscreen.html#infoscreen"><span class="std std-ref">infoscreen</span></a> (TV) to display metadata. A GAMA Agent-Based-Model (<a class="reference internal" href="ABM.html#abm"><span class="std std-ref">ABM</span></a>) can be executed via interaction on the table. The data it outputs is stored locally and loaded by the infoscreen to display comprehensive graphs.</p>
</section>
<section id="framework-architecture">
<span id="architecture"></span><h2>Framework Architecture<a class="headerlink" href="#framework-architecture" title="Permalink to this heading"></a></h2>
<p>go to the repositories listed below and download them; I would recommend putting them all into one project folder like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>project qScope
└───cspy_L
│   Token Tag Decoder (for left table)
└───cspy_R
|   Tag Decoder for the right table
└───data
└───q100_abm
└───qScope_infoscreen
│   infoscreen (NodeJS/ JavaScript)
└───qScope_frontend
    projection (Python)
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><p>cspy_L and cspy_R: <a class="reference external" href="https://github.com/quarree100/cspy">https://github.com/quarree100/cspy</a> (you’ll need this script twice - one for each table)</p></li>
<li><p>data: has to be linked from Seafile server as discussed <a class="reference internal" href="#data"><span class="std std-ref">below</span></a>.</p></li>
<li><p>GAMA: <a class="reference external" href="https://github.com/quarree100/q100_abm">https://github.com/quarree100/q100_abm</a></p></li>
<li><p>qScope_infoscreen: <a class="reference external" href="https://github.com/quarree100/qScope_infoscreen">https://github.com/quarree100/qScope_infoscreen</a></p></li>
<li><p>qScope_frontend: <a class="reference external" href="https://github.com/quarree100/qScope_frontend">https://github.com/quarree100/qScope_frontend</a></p></li>
</ul>
<p>Go directly to:</p>
<ul class="simple">
<li><p><a class="reference internal" href="frontend.html#frontend-installation"><span class="std std-ref">Installing the frontend</span></a></p></li>
<li><p><a class="reference internal" href="tag_decoder.html#installing-cspy"><span class="std std-ref">Installing the decoder</span></a></p></li>
<li><p><a class="reference internal" href="infoscreen.html#installing-infoscreen"><span class="std std-ref">Installing the infoscreen</span></a></p></li>
<li><p><a class="reference internal" href="ABM.html#installing-gama"><span class="std std-ref">Installing GAMA</span></a></p></li>
</ul>
</section>
<section id="data">
<span id="id1"></span><h2>Data<a class="headerlink" href="#data" title="Permalink to this heading"></a></h2>
<p>Q-Scope relies on a local data folder with GIS information on the map, the polygons and data on the houses that shall be displayed. The folder contains Shapefiles used to display both an aerial photograph (raster file) and polygon information for each houses to be able to interact with - provided as Shapefiles. Some additional, household-specific data in the form of csv files are provided, which can be lined to the polygons.</p>
<p>TODO: provide simple working example data folder without sensitive data!</p>
</section>
<section id="starting-the-software">
<h2>Starting the software<a class="headerlink" href="#starting-the-software" title="Permalink to this heading"></a></h2>
<p>You’ll need Python to start the <strong>frontend</strong>. The frontend will be started by navigating to the  project folder and do <code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">run_q100viz.py</span></code>. A window will open and show the contents that will be projected onto the table. This is the frontend the users can see and interact with:</p>
<a class="reference internal image-reference" href="_images/frontend_full.png"><img alt="You should see an image of the frontend here. It is basically a black canvas with a map on it and some buttons on the side." class="align-center" src="_images/frontend_full.png" style="width: 600px;" /></a>
<p>You see a lot of the black canvas around a slightly distorted map. This is due to the “keystoning”, the adjustment of the image for the angles the projector produces with respect to the table. By casting an appropriately distorted image onto the table, the distortion will even out, geometrically. ✨</p>
<p>Now we want to interact with the things we see on the canvas - the buttons, the sliders and the map. For this, we’ll need cspy, which serves as the <strong>backend</strong>, decoding the configuration of tangibles on the table.
Start the script for each table individually by navigating to the cspy folders and do <code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">run_keystone.py</span></code>. A window will show up to define the Region of Interest and do the <a class="reference internal" href="#calibrating-the-table"><span class="std std-ref">keystone calibration</span></a>. After doing this once, the adjustment will be saved and this step can be skipped next time.
The scanning will be started with <code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">run_scanner.py</span></code>. The decoder will send interaction data now to the frontend script, which will react by altering the projection.</p>
<p>In order for the <strong>infoscreen</strong> to receive and process information, it has to be started by executing <code class="docutils literal notranslate"><span class="pre">npm</span> <span class="pre">start</span></code> or <code class="docutils literal notranslate"><span class="pre">node</span> <span class="pre">q100_info.js</span></code> in the q100_info folder.</p>
<p>You can start each program individually, but be aware that, for the handshake between the programs to succeed, it is recommended to follow certain order:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">cspy_L</span>
<span class="n">python3</span> <span class="n">run_scanner</span><span class="o">.</span><span class="n">py</span>

<span class="n">cd</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">cspy_R</span>
<span class="n">python3</span> <span class="n">run_scanner</span><span class="o">.</span><span class="n">py</span>

<span class="n">cd</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">qScope_infoscreen</span>
<span class="n">node</span> <span class="n">q100_info</span><span class="o">.</span><span class="n">js</span>

<span class="n">cd</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">qScope_frontend</span>
<span class="n">python3</span> <span class="n">run_q100viz</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>We put these commands into a shell script called run_qScope.sh to be executed automatically upon startup of the computer.</p>
<section id="calibrating-the-table">
<span id="id2"></span><h3>Calibrating the Table:<a class="headerlink" href="#calibrating-the-table" title="Permalink to this heading"></a></h3>
<p>TODO: process of calibration with images and hotkeys</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="QUARREE100.html" class="btn btn-neutral float-left" title="QUARREE100" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="frontend.html" class="btn btn-neutral float-right" title="Frontend" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, dunland.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>